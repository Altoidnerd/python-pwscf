#!/usr/bin/env python3

import matplotlib.pyplot as plt
import numpy as np
import sys

# pw.x options
################
# ion initial kick temp = 300K
# dt = 50 a.u. (Ry) = 50*4.8378e-17 s 
# N_step = 300
#
#
#
# basic data
#################
# Ekins = [ ... ]
# Etots = [ ... ]
# temperatures = [ ... ]
#
#
#
# derived lists
#################
# Epots = [ Etots[i] - Ekins[i] for i in range(len(Ekins)) ] 
# norm_Etots = [ thing/Etots[0] for thing in Etots ]
# diff_Etots = [ thing - Etots[0] for thing in Etots ]
# average_temp = get_mean(temperatures)
# inds = range(len(Ekins))

dt=10
ry_atomic_time=4.8378e-17 #seconds per a.u.
timestep_SI = dt*ry_atomic_time
tempw=600

def get_mean(li):
  summe = 0
  for item in li:
    summe += item
  return int(summe/len(li))

def main():
  #plt.scatter(inds, Ekins, color='b', marker='s', s=65, label='Kinetic Energy (Ry)')
  #plt.plot(inds, Ekins, color='g', label='E_kinetic (Ry)')
  plt.plot(inds, norm_Etots, color='r', label='E_total[t]/(-548.00599230 Ry)')
  #plt.plot(inds, diff_Etots, color='k', label='E_total[t] - E_total[0] = E_total[t] + 548.00599230 Ry')


  #plt.scatter(ecut, etas_pbe_n,  color='g', marker='o', s=65, label='GGA: Cl.pbe-n-kjpaw_psl.1.0.0.UPF')
  #plt.scatter(ecut, etas_pz_nl,  color='r', marker='^', s=65, label='LDA: Cl.pz-nl-kjpaw_psl.1.0.0.UPF')
  #plt.scatter(ecut, etas_pz_n,   color='k', marker='<', s=65, label='LDA: Cl.pz-n-kjpaw_psl.1.0.0.UPF')
  #plt.plot(ecut, etas)

  plt.title("p-Cl_2-benzene MD, tempw={}K, dt={} a.u., T_avg={}K".format(tempw, dt, get_mean(temperatures)))
  plt.ylabel("Ry")
  plt.xlabel("time (simulation step: {} a.u. per step\n1 a.u. = {}s\n{} a.u. = {}s".format(dt, ry_atomic_time, dt,  timestep_SI))


  print(average_temp)
  plt.legend(loc=1)

  #plt.ylim(ymin=-547.5)

  plt.show()  



#### put big data vectors here

Etots = [-547.94043922,
-547.94034838,
-547.94020933,
-547.94006407,
-547.93994025,
-547.93985282,
-547.93980864,
-547.93981010,
-547.93985638,
-547.93994255,
-547.94005760,
-547.94017927,
-547.94027181,
-547.94029118,
-547.94020177,
-547.94000978,
-547.93978995,
-547.93966388,
-547.93971700,
-547.93992419,
-547.94016963,
-547.94033891,
-547.94038494,
-547.94032551,
-547.94020692,
-547.94007380,
-547.93995684,
-547.93987283,
-547.93982940,
-547.93982903,
-547.93987127,
-547.93995253,
-547.94006371,
-547.94018626,
-547.94028870,
-547.94032816,
-547.94026435,
-547.94008980,
-547.93986248,
-547.93970063,
-547.93971038,
-547.93989539,
-547.94014986,
-547.94034587,
-547.94041645,
-547.94036855,
-547.94024796,
-547.94010367,
-547.93997131,
-547.93987163,
-547.93981490,
-547.93980510,
-547.93984232,
-547.93992291,
-547.94003710,
-547.94016560,
-547.94027617,
-547.94032548,
-547.94027304,
-547.94011074,
-547.93989494,
-547.93974175,
-547.93975592,
-547.93994072,
-547.94019028,
-547.94037716,
-547.94043620,
-547.94037704,
-547.94024778,
-547.94009859,
-547.93996500,
-547.93986671,
-547.93981241,
-547.93980443,
-547.93984146,
-547.93991921,
-547.94002854,
-547.94015191,
-547.94026073,
-547.94031555,
-547.94027562,
-547.94012469,
-547.93990481,
-547.93972421,
-547.93969899,
-547.93985769,
-547.94010986,
-547.94032188,
-547.94041257,
-547.94037970,
-547.94026781,
-547.94012844,
-547.93999960,
-547.93990290,
-547.93984745,
-547.93983547,
-547.93986602,
-547.93993534,
-547.94003591,
-547.94015369,
-547.94026468,
-547.94033338,
-547.94031867,
-547.94019428,
-547.93998289,
-547.93977826,
-547.93970824,
-547.93983563,
-547.94009299,
-547.94033730,
-547.94046083,
-547.94044355,
-547.94032836,
-547.94017372,
-547.94002558,
-547.93991117,
-547.93984284,
-547.93982374,
-547.93985229,
-547.93992346,
-547.94002793,
-547.94014913,
-547.94026193,
-547.94033213,
-547.94032117,
-547.94020492,
-547.94000413,
-547.93980549,
-547.93973006,
-547.93984193,
-547.94008278,
-547.94031736,
-547.94043942,
-547.94042616,
-547.94031722,
-547.94016927,
-547.94002740,
-547.93991801,
-547.93985252,
-547.93983326,
-547.93985778,
-547.93992032,
-547.94001166,
-547.94011780,
-547.94021861,
-547.94028747,
-547.94029331,
-547.94021151,
-547.94004610,
-547.93985421,
-547.93973981,
-547.93978863,
-547.93998835,
-547.94022891,
-547.94039118,
-547.94042435,
-547.94034954,
-547.94021956,
-547.94008345,
-547.93997288,
-547.93990307,
-547.93987812,
-547.93989619,
-547.93995134,
-547.94003423,
-547.94013206,
-547.94022708,
-547.94029619,
-547.94031230,
-547.94025057,
-547.94010518,
-547.93991534,
-547.93977475,
-547.93978426,
-547.93996237,
-547.94021309,
-547.94040284,
-547.94045813,
-547.94038888,
-547.94024978,
-547.94009729,
-547.93996988,
-547.93988691,
-547.93985439,
-547.93987045,
-547.93992836,
-547.94001753,
-547.94012246,
-547.94022362,
-547.94029814,
-547.94032028,
-547.94026739,
-547.94013463,
-547.93995856,
-547.93982572,
-547.93982929,
-547.93998731,
-547.94021283,
-547.94038305,
-547.94042937,
-547.94036040,
-547.94022689,
-547.94008184,
-547.93996141,
-547.93988377,
-547.93985394,
-547.93986928,
-547.93992275,
-547.94000389,
-547.94009903,
-547.94019062,
-547.94025859,
-547.94028130,
-547.94023857,
-547.94012368,
-547.93996400,
-547.93983404,
-547.93982419,
-547.93996529,
-547.94018679,
-547.94037030,
-547.94043890,
-547.94039078,
-547.94027141,
-547.94013349,
-547.94001510,
-547.93993607,
-547.93990268,
-547.93991335,
-547.93996151,
-547.94003680,
-547.94012559,
-547.94021151,
-547.94027607,
-547.94029908,
-547.94026075,
-547.94015060,
-547.93998859,
-547.93984472,
-547.93981623,
-547.93994873,
-547.94017823,
-547.94037724,
-547.94045569,
-547.94040636,
-547.94027740,
-547.94012705,
-547.93999785,
-547.93991187,
-547.93987560,
-547.93988620,
-547.93993544,
-547.94001168,
-547.94010123,
-547.94018896,
-547.94025983,
-547.94029686,
-547.94027961,
-547.94019260,
-547.94004596,
-547.93990015,
-547.93985259,
-547.93996137,
-547.94017670,
-547.94037544,
-547.94046225,
-547.94042287,
-547.94030181,
-547.94015655,
-547.94002982,
-547.93994372,
-547.93990457,
-547.93990916,
-547.93994901,
-547.94001279,
-547.94008832,
-547.94016433,
-547.94023006,
-547.94027333,
-547.94027666,
-547.94021799,
-547.94008964,
-547.93993088,
-547.93983583,
-547.93989154,
-547.94008742,
-547.94031148,
-547.94044664,
-547.94045139,
-547.94035709,
-547.94022157,
-547.94009328,
-547.94000023,
-547.93995215,
-547.93994720,
-547.93997788,
-547.94003341,
-547.94010290,
-547.94017714,
-547.94024776]


Ekins = [0.13110616,
0.12819205,
0.12040319,
0.10975721,
0.09845528,
0.08842098,
0.08103172,
0.07698688,
0.07626204,
0.07812796,
0.08124460,
0.08387169,
0.08424456,
0.08113449,
0.07450476,
0.06596407,
0.05855759,
0.05559777,
0.05892775,
0.06775174,
0.07898473,
0.08886462,
0.09462713,
0.09530200,
0.09155992,
0.08507216,
0.07783162,
0.07164974,
0.06785626,
0.06715017,
0.06954573,
0.07438094,
0.08039118,
0.08588132,
0.08904842,
0.08849096,
0.08385206,
0.07636042,
0.06882765,
0.06470280,
0.06635986,
0.07364273,
0.08382517,
0.09306991,
0.09826904,
0.09811045,
0.09309393,
0.08491656,
0.07573769,
0.06760244,
0.06208106,
0.06007940,
0.06175993,
0.06653878,
0.07315930,
0.07987233,
0.08477260,
0.08632002,
0.08399057,
0.07882265,
0.07342682,
0.07106490,
0.07396633,
0.08189309,
0.09210769,
0.10083238,
0.10507838,
0.10368515,
0.09729947,
0.08772877,
0.07718985,
0.06773342,
0.06089862,
0.05754654,
0.05780708,
0.06109686,
0.06620243,
0.07145099,
0.07501033,
0.07535606,
0.07187838,
0.06544654,
0.05854430,
0.05453983,
0.05609083,
0.06353951,
0.07454373,
0.08532307,
0.09254984,
0.09460574,
0.09173820,
0.08548043,
0.07789093,
0.07094644,
0.06617219,
0.06446209,
0.06602024,
0.07037497,
0.07644817,
0.08269728,
0.08736731,
0.08889456,
0.08646224,
0.08058768,
0.07341853,
0.06827095,
0.06819796,
0.07419863,
0.08438753,
0.09492783,
0.10203610,
0.10359351,
0.09956995,
0.09149951,
0.08163512,
0.07222453,
0.06505000,
0.06119773,
0.06098003,
0.06395346,
0.06900944,
0.07454596,
0.07874577,
0.07999209,
0.07741245,
0.07143275,
0.06405223,
0.05841679,
0.05748611,
0.06233005,
0.07127734,
0.08072734,
0.08704068,
0.08812217,
0.08387984,
0.07574551,
0.06585967,
0.05636491,
0.04895808,
0.04467374,
0.04382243,
0.04602366,
0.05030380,
0.05525798,
0.05928980,
0.06094668,
0.05934953,
0.05465313,
0.04835618,
0.04313552,
0.04191546,
0.04636141,
0.05572052,
0.06702058,
0.07659822,
0.08181719,
0.08190592,
0.07776264,
0.07122682,
0.06433244,
0.05878672,
0.05569604,
0.05547219,
0.05785264,
0.06199444,
0.06663035,
0.07029378,
0.07161927,
0.06971756,
0.06458927,
0.05745613,
0.05074803,
0.04741249,
0.04951725,
0.05687009,
0.06681245,
0.07555667,
0.08008057,
0.07927498,
0.07392516,
0.06597551,
0.05768448,
0.05100125,
0.04722262,
0.04686676,
0.04968790,
0.05478501,
0.06078507,
0.06609609,
0.06922766,
0.06916981,
0.06578829,
0.06013007,
0.05440431,
0.05133799,
0.05288207,
0.05893190,
0.06712103,
0.07403414,
0.07694645,
0.07489125,
0.06865413,
0.06009255,
0.05134511,
0.04424650,
0.04000993,
0.03911664,
0.04134033,
0.04585847,
0.05142822,
0.05662041,
0.06010302,
0.06096591,
0.05905848,
0.05526115,
0.05150833,
0.05028439,
0.05349686,
0.06123147,
0.07137544,
0.08060500,
0.08604898,
0.08645391,
0.08231855,
0.07529737,
0.06742528,
0.06051333,
0.05580435,
0.05384193,
0.05448186,
0.05699585,
0.06024181,
0.06289059,
0.06369898,
0.06181552,
0.05709848,
0.05039346,
0.04361208,
0.03932064,
0.03965288,
0.04495957,
0.05324268,
0.06106178,
0.06531120,
0.06456456,
0.05930152,
0.05128660,
0.04271722,
0.03555139,
0.03112686,
0.03002456,
0.03209440,
0.03658128,
0.04231438,
0.04793639,
0.05215233,
0.05399184,
0.05308696,
0.04995078,
0.04614053,
0.04399815,
0.04569087,
0.05184602,
0.06080999,
0.06935955,
0.07441024,
0.07442385,
0.06972977,
0.06196371,
0.05323596,
0.04546067,
0.03997536,
0.03740791,
0.03770820,
0.04027630,
0.04414240,
0.04816622,
0.05123262,
0.05243754,
0.05129648,
0.04801595,
0.04376995,
0.04069941,
0.04122717,
0.04669732,
0.05622415,
0.06687794,
0.07522961,
0.07903234,
0.07792918,
0.07311014,
0.06650093,
0.06001718,
0.05510205,
0.05253478,
0.05242827,
0.05433910,
0.05743051,
0.06064988,
0.06289469]

temperatures = [
600.00000000,
586.66377139,
551.01848211,
502.29772788,
450.57510318,
404.65366142,
370.83712249,
352.32614719,
349.00896379,
357.54824550,
371.81136671,
383.83411430,
385.54053117,
371.30744232,
340.96686024,
301.88087593,
267.98555516,
254.44010841,
269.67957111,
310.06204139,
361.46922742,
406.68398687,
433.05579448,
436.14428870,
419.01885145,
389.32799414,
356.19205263,
327.90104583,
310.54036481,
307.30900771,
318.27215484,
340.40022309,
367.90574804,
393.03105325,
407.52513535,
404.97392846,
383.74425746,
349.45920273,
314.98589210,
296.10875170,
303.69220498,
337.02182455,
383.62122544,
425.92926949,
449.72275764,
448.99699783,
426.03918794,
388.61587965,
346.60929804,
309.37879790,
284.11048314,
274.95002321,
282.64089339,
304.51098922,
334.80943142,
365.53127874,
387.95704941,
395.03875316,
384.37815211,
360.72745999,
336.03375154,
325.22455896,
338.50278285,
374.77913372,
421.52569577,
461.45374964,
480.88534642,
474.50929624,
445.28557806,
401.48583899,
353.25505546,
309.97819659,
278.69911294,
263.35852572,
264.55088236,
279.60638364,
302.97174716,
326.99148227,
343.28060715,
344.86280818,
328.94738380,
299.51242693,
267.92473824,
249.59849791,
256.69656628,
290.78502704,
341.14523771,
390.47626709,
423.54917600,
432.95789575,
419.83476968,
391.19640830,
356.46348659,
324.68241952,
302.83331579,
295.00716091,
302.13796410,
322.06711375,
349.86079958,
378.45949930,
399.83161990,
406.82101083,
395.68961974,
368.80503272,
335.99582015,
312.43817881,
312.10416544,
339.56587420,
386.19483274,
434.43192283,
466.96249639,
474.08990917,
455.67629914,
418.74239425,
373.59854722,
330.53154451,
297.69770087,
280.06801082,
279.07169192,
292.67944779,
315.81783713,
341.15542070,
360.37563794,
366.07931943,
354.27373382,
326.90797978,
293.13146069,
267.34117701,
263.08198772,
285.24998480,
326.19678846,
369.44416049,
398.33683147,
403.28619567,
383.87142698,
346.64508894,
301.40310110,
257.95088330,
224.05390560,
204.44685512,
200.55092425,
210.62470244,
230.21252527,
252.88507468,
271.33647345,
278.91907028,
271.60980812,
250.11699661,
221.29934321,
197.40732148,
191.82375965,
212.17039281,
255.00185171,
306.71594971,
350.54749924,
374.43179491,
374.83787702,
355.87635997,
325.96555799,
294.41381672,
269.03413275,
254.88980662,
253.86538024,
264.75938187,
283.71407779,
304.93006286,
321.69556919,
327.76157111,
319.05852436,
295.58916654,
262.94479340,
232.24551517,
216.98060186,
226.61293009,
260.26280178,
305.76345353,
345.78089386,
366.48425892,
362.79752849,
338.31439045,
301.93321733,
263.98978991,
233.40437187,
216.11168931,
214.48308951,
227.39391016,
250.72051827,
278.17946568,
302.48507780,
316.81652726,
316.55175914,
301.07643968,
275.18188896,
248.97830641,
234.94543226,
242.01182604,
269.69856277,
307.17565351,
338.81312460,
352.14111071,
342.73563922,
314.19178546,
275.01020536,
234.97802021,
202.49165066,
183.10319228,
179.01513108,
189.19169058,
209.86872593,
235.35837314,
259.12012785,
275.05813096,
279.00708366,
270.27785444,
252.89957976,
235.72499823,
230.12368256,
244.82541441,
280.22239727,
326.64571710,
368.88427516,
393.79835507,
395.65148842,
376.72624168,
344.59421581,
308.56804450,
276.93588627,
255.38548964,
246.40459729,
249.33318415,
260.83832093,
275.69330189,
287.81527026,
291.51482589,
282.89526557,
261.30801336,
230.62285042,
199.58825483,
179.94873125,
181.46920549,
205.75497194,
243.66217433,
279.44584097,
298.89305337,
295.47611065,
271.39011797,
234.71024795,
195.49298640,
162.69896430,
142.45035593,
137.40570038,
146.87821567,
167.41218627,
193.64940188,
219.37822058,
238.67223973,
247.09062275,
242.94949658,
228.59693889,
211.15956835,
201.35509835,
209.10170116,
237.27042565,
278.29352068,
317.42012105,
340.53428971,
340.59661575,
319.11441432,
283.57344971,
243.63138541,
208.04823745,
182.94499659,
171.19519848,
172.56946902,
184.32224618,
202.01522479,
220.43000381,
234.46320382,
239.97749706,
234.75545540,
219.74232622,
200.31073431,
186.25858397,
188.67384775,
213.70768006,
257.30666354,
306.06315768,
344.28413126,
361.68709590,
356.63852739,
334.58449440,
304.33778627,
274.66527847,
252.17144040,
240.42247194,
239.93504161,
248.67986331,
262.82754408,
277.56078174,
287.83403727
]




Epots = [ Etots[i] - Ekins[i] for i in range(len(Ekins)) ] 
norm_Etots = [ thing/Etots[0] for thing in Etots ]
diff_Etots = [ thing - Etots[0] for thing in Etots ]
average_temp = get_mean(temperatures)
inds = range(len(Ekins))

if __name__ == '__main__':
  main()



