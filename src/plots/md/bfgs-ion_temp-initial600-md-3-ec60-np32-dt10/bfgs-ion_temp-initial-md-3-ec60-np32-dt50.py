#!/usr/bin/env python3

import matplotlib.pyplot as plt
import numpy as np
import sys

# pw.x options
################
# ion initial kick temp = 300K
# dt = 50 a.u. (Ry) = 50*4.8378e-17 s 
# N_step = 300
#
#
#
# basic data
#################
# Ekins = [ ... ]
# Etots = [ ... ]
# temperatures = [ ... ]
#
#
#
# derived lists
#################
# Epots = [ Etots[i] - Ekins[i] for i in range(len(Ekins)) ] 
# norm_Etots = [ thing/Etots[0] for thing in Etots ]
# diff_Etots = [ thing - Etots[0] for thing in Etots ]
# average_temp = get_mean(temperatures)
# inds = range(len(Ekins))

dt=50
ry_atomic_time=4.8378e-17 #seconds per a.u.
timestep_SI = dt*ry_atomic_time
tempw=300

def get_mean(li):
  summe = 0
  for item in li:
    summe += item
  return summe/len(li)

def main():
  #plt.scatter(inds, Ekins, color='b', marker='s', s=65, label='Kinetic Energy (Ry)')
  plt.plot(inds, Ekins, color='g', label='E_kinetic (Ry)')
  #plt.plot(inds, norm_Etots, color='r', label='E_total[t]/(-548.00599230 Ry)')
  #plt.plot(inds, diff_Etots, color='k', label='E_total[t] - E_total[0] = E_total[t] + 548.00599230 Ry')


  #plt.scatter(ecut, etas_pbe_n,  color='g', marker='o', s=65, label='GGA: Cl.pbe-n-kjpaw_psl.1.0.0.UPF')
  #plt.scatter(ecut, etas_pz_nl,  color='r', marker='^', s=65, label='LDA: Cl.pz-nl-kjpaw_psl.1.0.0.UPF')
  #plt.scatter(ecut, etas_pz_n,   color='k', marker='<', s=65, label='LDA: Cl.pz-n-kjpaw_psl.1.0.0.UPF')
  #plt.plot(ecut, etas)

  plt.title("p-Cl_2-benzene MD, tempw={}K, dt=50 a.u., T_avg={}K".format(tempw, get_mean(temperatures)))
  plt.ylabel("Ry")
  plt.xlabel("time (simulation step: {} a.u. per step\n1 a.u. = {}s\n50 a.u. = {}s".format(dt, ry_atomic_time,  timestep_SI))


  print(average_temp)
  plt.legend(loc=1)

  #plt.ylim(ymin=-547.5)

  plt.show()  




Etots = [-548.00599230,
-548.00136685,
-548.00312426,
-547.99943022,
-548.00456364,
-548.00128616,
-548.00373166,
-548.00007385,
-548.00436835,
-548.00096796,
-548.00392507,
-547.99989506,
-548.00415364,
-548.00074078,
-548.00359912,
-547.99856354,
-548.00364486,
-548.00098736,
-548.00422131,
-547.99879558,
-548.00287925,
-548.00017396,
-548.00364455,
-547.99885666,
-548.00192867,
-548.00000673,
-548.00359152,
-547.99945049,
-548.00103679,
-547.99946698,
-548.00276705,
-547.99978019,
-548.00062620,
-547.99925696,
-548.00195855,
-547.99992110,
-548.00063750,
-547.99916694,
-548.00151632,
-548.00017798,
-548.00001182,
-547.99841914,
-548.00106479,
-548.00140830,
-548.00025229,
-547.99896497,
-548.00003649,
-548.00106322,
-548.00056133,
-547.99945731,
-547.99949061,
-548.00116171,
-548.00072732,
-548.00036794,
-547.99969232,
-548.00126300,
-548.00050035,
-548.00090488,
-548.00005918,
-548.00192603,
-548.00072612,
-548.00108123,
-547.99999767,
-548.00166869,
-548.00120379,
-548.00236293,
-548.00026696,
-548.00139402,
-548.00089662,
-548.00310830,
-548.00121411,
-548.00206955,
-548.00011327,
-548.00236893,
-548.00133560,
-548.00296030,
-548.00097804,
-548.00319588,
-548.00120501,
-548.00265154,
-548.00058491,
-548.00377381,
-548.00151830,
-548.00325992,
-548.00023209,
-548.00347279,
-548.00150412,
-548.00413454,
-548.00077619,
-548.00355875,
-548.00106062,
-548.00440310,
-548.00047899,
-548.00372866,
-548.00141421,
-548.00470391,
-548.00084442,
-548.00366116,
-548.00000396,
-548.00403043,
-548.00131872,
-548.00437007,
-548.00066529,
-548.00409711,
-548.00077222,
-548.00374400,
-548.00008689,
-548.00378246,
-548.00065807,
-548.00372432,
-547.99926303,
-548.00351360,
-548.00101374,
-548.00471338,
-547.99885819,
-548.00179444,
-547.99947625,
-548.00380516,
-547.99952456,
-548.00172966,
-547.99974633,
-548.00294867,
-548.00000609,
-548.00129044,
-547.99926014,
-548.00222762,
-547.99975461,
-548.00047819,
-547.99926875,
-548.00250417,
-548.00054833,
-548.00029258,
-547.99906806,
-548.00157683,
-548.00111822,
-548.00022173,
-547.99857993,
-548.00069943,
-548.00155979,
-548.00121992,
-547.99950046,
-547.99996149,
-548.00107644,
-548.00067415,
-547.99983046,
-547.99974649,
-548.00205339,
-548.00079196,
-548.00071595,
-547.99933209,
-548.00184660,
-548.00105640,
-548.00119884,
-547.99908680,
-548.00206414,
-548.00181489,
-548.00205403,
-547.99949407,
-548.00162280,
-548.00135566,
-548.00243095,
-547.99961257,
-548.00124594,
-548.00106183,
-548.00289529,
-548.00067642,
-548.00149999,
-548.00040659,
-548.00275905,
-548.00033159,
-548.00177844,
-548.00101366,
-548.00301966,
-547.99997044,
-548.00119334,
-548.00049374,
-548.00330505,
-548.00110615,
-548.00166278,
-547.99971857,
-548.00276809,
-548.00143764,
-548.00220522,
-548.00030490,
-548.00235646,
-548.00048182,
-548.00230235,
-548.00046220,
-548.00291812,
-548.00102493,
-548.00257201,
-548.00027609,
-548.00281027,
-548.00072420,
-548.00280333,
-548.00029140,
-548.00274425,
-548.00124370,
-548.00302444,
-548.00069512,
-548.00317149,
-548.00077319,
-548.00303531,
-548.00104481,
-548.00346990,
-548.00047832,
-548.00315460,
-548.00117423,
-548.00408816,
-548.00070891,
-548.00244822,
-548.00054897,
-548.00384838,
-548.00144252,
-548.00289836,
-548.00093653,
-548.00332179,
-548.00099455,
-548.00231486,
-548.00083147,
-548.00319163,
-548.00148501,
-548.00239499,
-548.00118353,
-548.00318623,
-548.00178230,
-548.00203744,
-548.00010589,
-548.00200103,
-548.00231368,
-548.00244409,
-548.00039607,
-548.00183185,
-548.00216575,
-548.00243836,
-548.00099739,
-548.00067943,
-548.00124038,
-548.00160497,
-548.00082456,
-548.00074190,
-548.00226095,
-548.00193903,
-548.00092357,
-547.99930086,
-548.00159292,
-548.00179959,
-548.00148393,
-547.99917965,
-548.00104425,
-548.00181997,
-548.00153828,
-547.99967088,
-548.00010802,
-548.00131263,
-548.00107992,
-547.99898451,
-547.99997860,
-548.00141455,
-548.00125170,
-547.99908654,
-547.99927885,
-548.00022672,
-548.00062856,
-547.99884018,
-547.99897150,
-548.00045070,
-548.00055222,
-547.99836691,
-547.99816419,
-547.99958307,
-548.00005845,
-547.99841347,
-547.99784590,
-547.99880011,
-547.99833389,
-547.99800240,
-547.99759040,
-547.99924931,
-547.99695974,
-547.99622356,
-547.99642705,
-547.99823197,
-547.99689482,
-547.99553079,
-547.99514050,
-547.99719387,
-547.99587416,
-547.99442766,
-547.99449251,
-547.99747041,
-547.99364224,
-547.99251035,
-547.99222489,
-547.99703055,
-547.99125230,
-547.98829092,
-547.98807580,
-547.99527675,
-547.98617671]

Ekins = [0.06555308,
0.05006031,
0.03354811,
0.02188160,
0.03021930,
0.03011863,
0.03188122,
0.03016027,
0.03810736,
0.03615166,
0.03769477,
0.03250093,
0.03507613,
0.02722836,
0.02365507,
0.01829070,
0.03267614,
0.04038727,
0.04585826,
0.03584327,
0.03804918,
0.03737341,
0.04101630,
0.03202451,
0.03381345,
0.03831263,
0.04600496,
0.03577125,
0.02888933,
0.02853609,
0.03639669,
0.03112063,
0.02607562,
0.02577404,
0.03438950,
0.03434332,
0.03231980,
0.03022363,
0.03446732,
0.03166698,
0.02543796,
0.02476320,
0.04003397,
0.04914085,
0.04223472,
0.03268916,
0.03428664,
0.03959923,
0.03642159,
0.02739191,
0.02524835,
0.03289708,
0.03576642,
0.03153582,
0.02631513,
0.02928060,
0.03157060,
0.03150480,
0.02921923,
0.03189618,
0.03017283,
0.02682721,
0.02382254,
0.03077375,
0.03889992,
0.04089667,
0.03111893,
0.02935056,
0.03693774,
0.04572479,
0.03849292,
0.02738915,
0.02006046,
0.02635276,
0.03114370,
0.03432098,
0.03296054,
0.03577880,
0.03114918,
0.02670165,
0.02480137,
0.03344961,
0.03210864,
0.02680899,
0.01981980,
0.02946444,
0.03706866,
0.04027691,
0.03168618,
0.03331237,
0.03437791,
0.03700126,
0.02878527,
0.03419228,
0.04004092,
0.04311404,
0.02891916,
0.02243732,
0.01912400,
0.03062868,
0.03395157,
0.03854572,
0.03599580,
0.03776151,
0.02808946,
0.02449332,
0.02173580,
0.02992052,
0.02766812,
0.02911551,
0.02999022,
0.04671112,
0.05149578,
0.04912636,
0.02850122,
0.02338502,
0.02449369,
0.03494826,
0.03227806,
0.03586547,
0.03909944,
0.04515245,
0.03851856,
0.03293948,
0.02715271,
0.02754636,
0.02153174,
0.02234614,
0.03028335,
0.04301324,
0.03996710,
0.03371541,
0.03338188,
0.04084504,
0.03841565,
0.02865305,
0.02493676,
0.03711769,
0.04779520,
0.04614102,
0.03664895,
0.03236894,
0.03245186,
0.03007620,
0.02827202,
0.03297030,
0.04013027,
0.03651847,
0.03060937,
0.02586785,
0.02932130,
0.02854531,
0.02645797,
0.02503758,
0.03603839,
0.04323046,
0.04242284,
0.03452416,
0.03497823,
0.03690079,
0.03631962,
0.02767962,
0.02781582,
0.03473115,
0.04392339,
0.04009825,
0.03205137,
0.02676995,
0.03155249,
0.03093394,
0.03097344,
0.02968620,
0.03042859,
0.02312737,
0.02176221,
0.02695489,
0.03986090,
0.04013176,
0.03253209,
0.02565813,
0.03601854,
0.04337811,
0.04079387,
0.03008774,
0.02803322,
0.02914603,
0.03404988,
0.03304756,
0.03775693,
0.03910842,
0.03806426,
0.02797524,
0.02548441,
0.02481978,
0.02855662,
0.02373301,
0.02593480,
0.03093071,
0.03744707,
0.03318058,
0.03171945,
0.03047398,
0.03719827,
0.03534864,
0.03281570,
0.02858370,
0.03706721,
0.03963854,
0.03926965,
0.02829528,
0.02779999,
0.03086789,
0.03959111,
0.03769223,
0.03716167,
0.03308069,
0.03016580,
0.02080803,
0.02098963,
0.02603647,
0.03414294,
0.03332223,
0.03632957,
0.04155428,
0.04601208,
0.03690094,
0.02656432,
0.02209276,
0.03045294,
0.03687299,
0.03640803,
0.03520738,
0.04339021,
0.04715538,
0.04219439,
0.03185174,
0.02485841,
0.02227092,
0.02308804,
0.02800876,
0.03815252,
0.04509659,
0.03946636,
0.03011165,
0.02614064,
0.03275636,
0.03485584,
0.03220486,
0.02879418,
0.03507602,
0.04118677,
0.04167830,
0.03566578,
0.03170957,
0.03284269,
0.03337379,
0.03185361,
0.03618190,
0.04267854,
0.04301507,
0.03478618,
0.02679051,
0.02548055,
0.02935336,
0.03036105,
0.03096912,
0.03581408,
0.04056287,
0.03650421,
0.03037573,
0.03176519,
0.03826076,
0.03789757,
0.02913384,
0.02524671,
0.03304549,
0.04426001,
0.04396726,
0.03915269,
0.03381473,
0.03585271,
0.03655248,
0.03638336,
0.03562045,
0.03471708,
0.02926514,
0.02610584,
0.02868354,
0.03600487,
0.03857977,
0.03663662,
0.03180889,
0.03683063,
0.03839605,
0.03754479,
0.02763740,
0.02757037,
0.03267310,
0.04586476,
0.04477010]

temperatures = [300.00000000,
229.09819224,
153.53103035,
100.13990904,
138.29694659,
137.83623704,
145.90263717,
138.02678421,
174.39621152,
165.44605015,
172.50802375,
148.73871298,
160.52395424,
124.60907095,
108.25611287,
83.70636614,
149.54053482,
184.83007968,
209.86777515,
164.03473853,
174.12993019,
171.03733907,
187.70880501,
146.55839019,
154.74536729,
175.33563081,
210.53913986,
163.70514074,
132.21042536,
130.59382739,
166.56741330,
142.42183692,
119.33360912,
117.95347769,
157.38162653,
157.17026673,
147.90977255,
138.31674003,
157.73775880,
144.92214561,
116.41539102,
113.32739257,
183.21321040,
224.89035428,
193.28484923,
149.60012900,
156.91088677,
181.22364670,
166.68139437,
125.35755793,
115.54765274,
150.55164267,
163.68303607,
144.32191006,
120.42970684,
134.00102019,
144.48110918,
144.17995477,
133.72016951,
145.97106919,
138.08427765,
122.77320850,
109.02254041,
140.83434677,
178.02331198,
187.16132058,
142.41405223,
134.32121598,
169.04351534,
209.25694083,
176.16069393,
125.34492154,
91.80558633,
120.60193981,
142.52742633,
157.06802621,
150.84206577,
163.73966082,
142.55248644,
122.19859094,
113.50209932,
153.08027100,
146.94337628,
122.68985034,
90.70422069,
134.84237723,
169.64265939,
184.32503986,
145.01001835,
152.45219807,
157.32856711,
169.33419421,
131.73419753,
156.47905207,
183.24502821,
197.30899872,
132.34692584,
102.68315597,
87.51993744,
140.17046029,
155.37747006,
176.40232395,
164.73275447,
172.81344207,
128.54985779,
112.09229358,
99.47267506,
136.92957938,
126.62162314,
133.24548439,
137.24858560,
213.77083135,
235.66754117,
224.82406248,
130.43422825,
107.02024501,
112.09400805,
159.93877322,
147.71874452,
164.13634253,
178.93640144,
206.63766642,
176.27803108,
150.74568638,
124.26287186,
126.06437616,
98.53879380,
102.26584490,
138.59007876,
196.84767142,
182.90721407,
154.29666968,
152.77031069,
186.92503663,
175.80709980,
131.12909548,
114.12170475,
169.86705544,
218.73204492,
211.16180996,
167.72189393,
148.13463942,
148.51414413,
137.64205533,
129.38531701,
150.88674424,
183.65394862,
167.12475246,
140.08207366,
118.38277877,
134.18728088,
130.63599793,
121.08343900,
114.58307834,
164.92770248,
197.84179274,
194.14574543,
157.99786829,
160.07592841,
168.87441865,
166.21469520,
126.67422485,
127.29754761,
158.94517523,
201.01292136,
183.50738676,
146.68131784,
122.51116253,
144.39819453,
141.56744848,
141.74822105,
135.85722266,
139.25472092,
105.84110253,
99.59353081,
123.35755470,
182.42116720,
183.66077055,
148.88130761,
117.42298979,
164.83681717,
198.51751956,
186.69087443,
137.69487716,
128.29247948,
133.38519456,
155.82738393,
151.24032696,
172.79246826,
178.97750430,
174.19895798,
128.02714447,
116.62797407,
113.58635756,
130.68775624,
108.61278987,
118.68918040,
141.55266115,
171.37444278,
151.84906855,
145.16230817,
139.46248799,
170.23579502,
161.77109725,
150.17923716,
130.81168569,
169.63600966,
181.40354913,
179.71535145,
129.49178269,
127.22510718,
141.26519811,
181.18651331,
172.49638322,
170.06832858,
151.39193020,
138.05211723,
95.22680414,
96.05789068,
119.15445341,
156.25326760,
152.49733359,
166.26022638,
190.17082451,
210.57170195,
168.87507641,
121.57014700,
101.10627577,
139.36619986,
168.74718049,
166.61933235,
161.12459397,
198.57285697,
215.80394213,
193.10028490,
145.76769932,
113.76311824,
101.92161866,
105.66112960,
128.18052010,
174.60285713,
206.38204144,
180.61559036,
137.80429550,
119.63116822,
149.90764255,
159.51579126,
147.38375782,
131.77495135,
160.52346678,
188.48896518,
190.73843464,
163.22243932,
145.11706671,
150.30273146,
152.73329334,
145.77626680,
165.58445772,
195.31596404,
196.85607750,
159.19699029,
122.60525825,
116.61033573,
134.33400590,
138.94565398,
141.72847075,
163.90114193,
185.63371950,
167.05949764,
139.01285208,
145.37160685,
175.09824142,
173.43612059,
133.32937425,
115.54016024,
151.23081931,
202.55346270,
201.21372182,
179.18009405,
154.75123044,
164.07790607,
167.28040377,
166.50639784,
163.01500742,
158.88077601,
133.93029411,
119.47191219,
131.26862773,
164.77426435,
176.55816975,
167.66543632,
145.57162952,
168.55331230,
175.71737756,
171.82161780,
126.48103766,
126.17424745,
149.52661431,
209.89752081,
204.88786646]

Epots = [ Etots[i] - Ekins[i] for i in range(len(Ekins)) ] 
norm_Etots = [ thing/Etots[0] for thing in Etots ]
diff_Etots = [ thing - Etots[0] for thing in Etots ]
average_temp = get_mean(temperatures)
inds = range(len(Ekins))

if __name__ == '__main__':
  main()


